<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¾é£Ÿèœè°± - è®¾è®¡ç‰ˆ</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "PingFang SC", -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif;
            color: #333;
            background-color: #f8f8f8;
            line-height: 1.5;
        }
        
        .container {
            max-width: 750px; /* æŒ‰ç…§è®¾è®¡ç¨¿å®½åº¦ */
            margin: 0 auto;
            background: linear-gradient(179deg, #FFFFFF 0%, #F1F1F2 15%);
            min-height: 100vh;
            padding-top: 156px; /* æ·»åŠ é¡¶éƒ¨å†…è¾¹è·ï¼Œä½¿è¯†åˆ«é£ŸæåŒºåŸŸè·ç¦»é¡µé¢é¡¶éƒ¨ä¸º156px */
        }
        
        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .navbar {
            display: flex;
            align-items: center;
            height: 88px;
            padding: 0 32px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: transparent;
            z-index: 100;
            max-width: 750px;
            margin: 0 auto;
        }
        
        .navbar .title {
            display: none; /* éšè—é¡¶éƒ¨æ ‡é¢˜ */
        }
        
        .navbar .back {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 24px;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: 22px;
        }
        
        /* é£Ÿæè¯†åˆ«åŒºåŸŸ */
        .recognition-area {
            padding: 24px 32px;
            background: transparent;
            margin-top: 0; /* ç§»é™¤margin-top */
        }
        
        .ingredients-list {
            display: flex;
            overflow-x: auto;
            gap: 16px;
            padding-bottom: 8px;
            scrollbar-width: none; /* Firefox */
        }
        
        .ingredients-list::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }
        
        .ingredient-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 94px;
            cursor: pointer;
        }
        
        /* å›ºå®šå°ºå¯¸çš„å›¾ç‰‡å®¹å™¨ */
        .img-container {
            width: 94px;
            height: 94px;
            border-radius: 12px;
            background-color: #f0f0f0;
            overflow: hidden;
            position: relative;
            margin-bottom: 8px;
            border: 1px solid #FFFFFF;
            transition: all 0.2s ease;
        }
        
        /* æ´»è·ƒçŠ¶æ€çš„é£Ÿæ */
        .ingredient-item.active .img-container {
            border: 2px solid #FFDD00;
            box-shadow: 0 2px 8px rgba(255, 221, 0, 0.3);
        }
        
        /* é£Ÿæå›¾ç‰‡æ»¤é•œ */
        .ingredient-item .img-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(59, 59, 59, 0.2);
            z-index: 1;
        }
        
        /* éšè—é£Ÿæåç§° */
        .ingredient-name {
            display: none;
        }
        
        /* èœè°±åˆ—è¡¨ */
        .recipe-section {
            padding: 0 24px;
            margin-top: 0;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px; /* è°ƒæ•´ä¸º16pxï¼Œä½¿ç­›é€‰å™¨è·ç¦»æ–‡å­—16px */
            margin-top: 20px; /* è·ç¦»å¤§ç™½å¡ä¸Šè¾¹ç¼˜20px */
            padding: 0; /* ç§»é™¤å†…è¾¹è·ï¼Œç»Ÿä¸€å¸ƒå±€ */
        }
        
        .section-title {
            font-size: 32px;
            font-weight: 500;
            color: #3D3D3D;
            line-height: 44px;
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .section-title::after {
            content: 'ğŸ’¡';
            margin-left: 4px;
        }
        
        .view-all {
            font-size: 28px;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        
        .recipe-list {
            display: flex;
            flex-direction: column;
            gap: 32px;
        }
        
        /* é£Ÿæé¢æ¿ - é»˜è®¤éšè— */
        .ingredient-panel {
            display: none;
        }
        
        /* æ´»è·ƒçš„é£Ÿæé¢æ¿ */
        .ingredient-panel.active {
            display: block;
        }
        
        /* ç™½è‰²é¢æ¿ - æ–°å¢ */
        .white-panel {
            background-color: #FFFFFF;
            border-radius: 24px 24px 0 0;
            margin-top: 24px; /* è·ç¦»è¯†åˆ«é£Ÿæçš„ä¸‹è¾¹è·ç¦»24px */
            padding-top: 0; /* ç§»é™¤å†…è¾¹è·ï¼Œç”±å†…éƒ¨å…ƒç´ æ§åˆ¶ */
            padding-bottom: 32px;
        }
        
        /* èœè°±æ ‡ç­¾å®¹å™¨ */
        .recipe-tags-container {
            display: flex;
            overflow-x: auto;
            gap: 12px;
            padding: 0 0 16px 0;
            margin: 16px 0;
            padding-left: 24px;
            padding-right: 24px;
            scrollbar-width: none; /* Firefox */
        }
        
        .recipe-tags-container::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Edge */
        }
        
        /* èœè°±å¡ç‰‡ - 3å±‚ç»“æ„ */
        .recipe-card {
            position: relative;
            height: 348px;
            margin-bottom: 16px;
            border-radius: 24px;
            overflow: hidden;
        }
        
        /* åº•å±‚ - ç™½è‰²åŠé€æ˜èƒŒæ™¯ + æ¨¡ç³Šæ•ˆæœ */
        .recipe-card-bottom {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 24px;
            z-index: 1;
        }
        
        /* ä¸­å±‚ - æ¸…æ™°èœè°±å›¾ */
        .recipe-card-middle {
            position: absolute;
            top: 3px;
            left: 3px;
            width: calc(100% - 6px);
            height: calc(77% - 3px); /* 269px/348px */
            border-radius: 22px;
            overflow: hidden;
            z-index: 2;
        }
        
        .recipe-card-middle img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* é¡¶å±‚ - æ–‡å­—ã€æŒ‰é’®å’Œå…¶ä»–å…ƒç´  */
        .recipe-card-top {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 24px;
            padding: 18px 24px;
            z-index: 3;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        /* é¡¶å±‚æ¸å˜é®ç½© */
        .recipe-card-overlay {
            position: absolute;
            top: 3px;
            left: 3px;
            width: calc(100% - 6px);
            height: calc(77% - 3px);
            border-radius: 22px;
            background: linear-gradient(180deg, rgba(26, 26, 26, 0.63) 10%, rgba(53, 53, 53, 0) 53%);
            z-index: 2;
        }
        
        .recipe-title {
            font-size: 42px;
            font-weight: 700;
            color: white;
            margin-bottom: 12px;
            line-height: 1.2;
            position: relative;
            z-index: 3;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            max-width: 80%;
        }
        
        .recipe-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            position: relative;
            z-index: 3;
        }
        
        .recipe-tag {
            font-size: 24px;
            color: white;
            margin-right: 0;
            background-color: transparent;
            padding: 0;
            border-radius: 0;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        /* é£Ÿæå±•ç¤ºåŒºåŸŸ */
        .recipe-ingredients {
            position: absolute;
            left: 24px;
            width: calc(100% - 240px); /* ä½¿ç”¨å›ºå®šå®½åº¦ï¼Œé¿å…ä¸æŒ‰é’®é‡å  */
            right: auto; /* ç§»é™¤rightå±æ€§ï¼Œä½¿ç”¨widthæ§åˆ¶ */
            bottom: 10px; /* ç”±åŸæ¥çš„20pxä¸‹ç§»åˆ°10px */
            height: 145px;
            display: flex;
            justify-content: flex-start; /* ç¡®ä¿é£Ÿæä»å·¦ä¾§å¼€å§‹æ’åˆ— */
        }
        
        /* å•ä¸ªé£Ÿæå¡ç‰‡ */
        .recipe-ingredient {
            position: relative;
            width: 92px;
            text-align: center;
            z-index: 1;
        }
        
        /* é‡ç½®é£Ÿæçš„z-indexï¼ˆä½¿ç”¨JSæ‰‹åŠ¨æ§åˆ¶ï¼‰ */
        .recipe-ingredient:nth-child(1) { z-index: auto; }
        .recipe-ingredient:nth-child(2) { z-index: auto; }
        .recipe-ingredient:nth-child(3) { z-index: auto; }
        .recipe-ingredient:nth-child(4) { z-index: auto; }
        
        /* åœ†å½¢å›¾ç‰‡å®¹å™¨ */
        .ingredient-img {
            width: 92px;
            height: 92px;
            border-radius: 50%;
            border: 2px solid white;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            background-color: #f5f5f5;
            margin: 0 auto 10px;
        }
        
        .ingredient-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* é£Ÿæåç§°æ ‡ç­¾ */
        .ingredient-label {
            font-size: 22px;
            color: #3D3D3D;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 30px;
            width: 100%;
        }
        
        /* å·²æœ‰æ ‡ç­¾ */
        .ingredient-has {
            position: absolute;
            top: auto; /* ç§»é™¤é¡¶éƒ¨å®šä½ */
            bottom: 50px; /* è°ƒæ•´ä½ç½®,ç¦»åœ†å½¢å®¹å™¨åº•éƒ¨50px */
            left: 50%;
            transform: translateX(-50%);
            background: rgba(39, 39, 39, 0.8);
            color: white;
            font-size: 18px;
            padding: 0 8px;
            border-radius: 30px;
            height: 29px;
            line-height: 29px;
            white-space: nowrap;
            z-index: 20; /* æé«˜z-indexï¼Œç¡®ä¿æ ‡ç­¾å§‹ç»ˆæ˜¾ç¤ºåœ¨æœ€ä¸Šå±‚ */
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* æ·»åŠ é˜´å½±å¢å¼ºå¯è§æ€§ */
        }
        
        /* é£Ÿæè´­ä¹°æŒ‰é’® */
        .purchase-btn {
            position: absolute;
            bottom: 45px; /* ä¸Šç§»5pxï¼Œä»40pxæ”¹ä¸º45px */
            right: 24px;
            background: linear-gradient(90deg, #343B45 0%, #272727 100%);
            color: white;
            border: none;
            border-radius: 33px;
            padding: 0 10px 0 18px; /* å‡å°å†…è¾¹è· */
            height: 60px; /* å‡å°é«˜åº¦ */
            font-size: 26px; /* å‡å°å­—ä½“ */
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            z-index: 15; /* æé«˜å±‚çº§ï¼Œç¡®ä¿ä¸ä¼šè¢«é£Ÿæé®æŒ¡ */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); /* è½»å¾®çš„é˜´å½±æ•ˆæœ */
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            min-width: 110px;
            max-width: 160px;
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
        }
        
        .purchase-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .purchase-btn-arrow {
            width: 36px; /* å‡å°ç®­å¤´åŒºåŸŸå®½åº¦ */
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 8px; /* å‡å°å·¦è¾¹è· */
            font-size: 20px;
        }
        
        /* å ä½ç¬¦æ ·å¼ */
        .placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            color: #999;
            font-size: 24px;
            text-align: center;
            padding: 10px;
        }
        
        /* æ¸è¿›å¼åŠ è½½å›¾ç‰‡æ ·å¼ */
        .progressive-img {
            opacity: 0;
            transition: opacity 0.3s ease-in;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .progressive-img.loaded {
            opacity: 1;
        }
        
        /* ç­›é€‰å™¨æ ·å¼ */
        .filter-container {
            display: flex;
            gap: 12px;
            padding: 0;
            overflow-x: auto;
            scrollbar-width: none;
            margin-top: 0; /* å·²ç”±section-headerçš„margin-bottomæ§åˆ¶ */
            margin-bottom: 12px; /* èœè°±å¡ç‰‡è·ç¦»ç­›é€‰å™¨12px */
        }
        
        .filter-container::-webkit-scrollbar {
            display: none;
        }
        
        .filter-item {
            height: 48px;
            padding: 0 24px;
            background-color: #F7F7F7;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
        }
        
        .filter-text {
            font-size: 24px;
            color: #555555;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 750px) {
            .container {
                width: 100%;
            }
            
            .navbar {
                height: 64px;
                padding: 0 16px;
            }
            
            .navbar .title {
                font-size: 24px;
            }
            
            .navbar .back {
                width: 32px;
                height: 32px;
                font-size: 18px;
            }
            
            .recognition-area {
                padding: 16px;
                margin-top: 24px;
            }
            
            .ingredient-item {
                min-width: 80px;
            }
            
            .img-container {
                width: 80px;
                height: 80px;
            }
            
            .section-title {
                font-size: 24px;
            }
            
            .view-all {
                font-size: 18px;
            }
            
            .recipe-card {
                height: 300px;
            }
            
            .recipe-title {
                font-size: 32px;
            }
            
            .recipe-tag {
                font-size: 18px;
            }
            
            .ingredient-img {
                width: 70px;
                height: 70px;
            }
            
            .ingredient-label {
                font-size: 16px;
            }
            
            .purchase-btn {
                padding: 12px 24px;
                font-size: 20px;
                border-radius: 24px;
            }
            
            .purchase-btn-arrow {
                width: 32px;
                height: 32px;
                margin-left: 8px;
            }
            
            .filter-item {
                height: 40px;
                padding: 0 16px;
            }
            
            .filter-text {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <div class="navbar">
            <div class="back" onclick="goBack()">ï¼œ</div>
            <div class="title">é£Ÿæè¯†åˆ«ä¸èœè°±æ¨è</div>
            <div style="width: 44px;"></div>
        </div>
        
        <!-- é£Ÿæè¯†åˆ«åŒºåŸŸ -->
        <div class="recognition-area">
            <div class="ingredients-list" id="ingredientsList">
                <!-- é£Ÿæåˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- èœè°±æ¨èåŒºåŸŸ -->
        <div class="white-panel">
            <div id="recipePanels">
                <!-- èœè°±é¢æ¿å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>
    
    <script>
        // é£Ÿææ•°æ®
        const ingredients = [
            {
                id: 'asparagus',
                name: 'èŠ¦ç¬‹',
                image: 'https://images.pexels.com/photos/273838/pexels-photo-273838.jpeg'
            },
            {
                id: 'shrimp',
                name: 'è™¾ä»',
                image: 'https://images.unsplash.com/photo-1565680018434-b513d5e5fd47'
            },
            {
                id: 'bacon',
                name: 'åŸ¹æ ¹',
                image: 'https://images.unsplash.com/photo-1528607929212-2636ec44253e'
            },
            {
                id: 'steak',
                name: 'ç‰›æ’',
                image: 'https://images.unsplash.com/photo-1546964124-0cce460f38ef'
            },
            {
                id: 'egg',
                name: 'é¸¡è›‹',
                image: 'https://images.unsplash.com/photo-1587486913049-53fc88980cfc'
            },
            {
                id: 'tomato',
                name: 'ç•ªèŒ„',
                image: 'https://images.unsplash.com/photo-1561136594-7f68413baa99'
            },
            // æ·»åŠ æ›´å¤šå¸¸ç”¨é£Ÿæ
            {
                id: 'pasta',
                name: 'æ„é¢',
                image: 'https://images.unsplash.com/photo-1551183053-bf91a1d81141'
            },
            {
                id: 'rice',
                name: 'ç±³é¥­',
                image: 'https://images.unsplash.com/photo-1536304993881-ff6e9eefa2a6'
            },
            {
                id: 'bread',
                name: 'é¢åŒ…',
                image: 'https://images.unsplash.com/photo-1589367920969-ab8e050bbb04'
            },
            {
                id: 'lettuce',
                name: 'ç”Ÿèœ',
                image: 'https://images.unsplash.com/photo-1622205313162-be1d5712a2e0'
            },
            {
                id: 'mushroom',
                name: 'è˜‘è‡',
                image: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836'
            },
            {
                id: 'onion',
                name: 'æ´‹è‘±',
                image: 'https://images.unsplash.com/photo-1580201092675-a0a6a6cafbb1'
            },
            {
                id: 'garlic',
                name: 'å¤§è’œ',
                image: 'https://images.unsplash.com/photo-1540148426945-6cf22a6b2383'
            },
            {
                id: 'potato',
                name: 'åœŸè±†',
                image: 'https://images.unsplash.com/photo-1518977676601-b53f82aba655'
            },
            {
                id: 'carrot',
                name: 'èƒ¡èåœ',
                image: 'https://images.unsplash.com/photo-1590165482129-1b8b27698780'
            },
            {
                id: 'pepper',
                name: 'å½©æ¤’',
                image: 'https://images.unsplash.com/photo-1563565375-f3fdfdbefa83'
            }
        ];
        
        // èœè°±æ•°æ® - æ¯ç§é£Ÿæå¯¹åº”6-8ä¸ªèœè°±
        const recipes = {
            asparagus: [
                {
                    id: 'asparagus_shrimp',
                    title: 'èŠ¦ç¬‹ç‚’è™¾ä»',
                    image: 'https://images.pexels.com/photos/3184183/pexels-photo-3184183.jpeg',
                    tags: ['å¿«æ‰‹èœ', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                },
                {
                    id: 'asparagus_bacon',
                    title: 'é¦™ç…èŠ¦ç¬‹åŸ¹æ ¹',
                    image: 'https://images.pexels.com/photos/6275217/pexels-photo-6275217.jpeg',
                    tags: ['å®¶å¸¸èœ', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                },
                {
                    id: 'asparagus_steak',
                    title: 'ç‰›æ’é…çƒ¤èŠ¦ç¬‹',
                    image: 'https://images.pexels.com/photos/10325726/pexels-photo-10325726.jpeg',
                    tags: ['è¥¿é¤', '30åˆ†é’Ÿ'],
                    time: '30åˆ†é’Ÿ'
                },
                {
                    id: 'asparagus_salad',
                    title: 'èŠ¦ç¬‹æ²™æ‹‰',
                    image: 'https://images.pexels.com/photos/6060858/pexels-photo-6060858.jpeg',
                    tags: ['å‡‰èœ', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                {
                    id: 'asparagus_soup',
                    title: 'èŠ¦ç¬‹æµ“æ±¤',
                    image: 'https://images.pexels.com/photos/5865052/pexels-photo-5865052.jpeg',
                    tags: ['æ±¤å“', '25åˆ†é’Ÿ'],
                    time: '25åˆ†é’Ÿ'
                },
                {
                    id: 'asparagus_pasta',
                    title: 'èŠ¦ç¬‹æ„é¢',
                    image: 'https://images.pexels.com/photos/1279330/pexels-photo-1279330.jpeg',
                    tags: ['æ„é¤', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                }
            ],
            shrimp: [
                {
                    id: 'shrimp_garlic',
                    title: 'è’œè“‰è™¾ä»',
                    image: 'https://images.unsplash.com/photo-1625944525533-473f1a3d54e7',
                    tags: ['å¿«æ‰‹èœ', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                },
                {
                    id: 'shrimp_egg',
                    title: 'è™¾ä»ç‚’è›‹',
                    image: 'https://images.unsplash.com/photo-1625944501841-279a4962ef68',
                    tags: ['å®¶å¸¸èœ', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                // æ·»åŠ æ›´å¤šè™¾ä»èœè°±...
                {
                    id: 'shrimp_pasta',
                    title: 'è™¾ä»æ„é¢',
                    image: 'https://images.unsplash.com/photo-1563379926898-05f4575a45d8',
                    tags: ['æ„é¤', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                },
                {
                    id: 'shrimp_fried_rice',
                    title: 'è™¾ä»ç‚’é¥­',
                    image: 'https://images.unsplash.com/photo-1603133872878-684f208fb84b',
                    tags: ['ä¸»é£Ÿ', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                },
                {
                    id: 'shrimp_salad',
                    title: 'è™¾ä»æ²™æ‹‰',
                    image: 'https://images.unsplash.com/photo-1551248429-40975aa4de74',
                    tags: ['å‡‰èœ', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                {
                    id: 'shrimp_soup',
                    title: 'è™¾ä»è±†è…æ±¤',
                    image: 'https://images.unsplash.com/photo-1626201850133-172331bdd6aa',
                    tags: ['æ±¤å“', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                }
            ],
            // å…¶ä»–é£Ÿæçš„èœè°±æ•°æ®...
            bacon: [
                {
                    id: 'bacon_egg',
                    title: 'åŸ¹æ ¹ç…è›‹',
                    image: 'https://images.unsplash.com/photo-1525351484163-7529414344d8',
                    tags: ['æ—©é¤', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                {
                    id: 'bacon_pasta',
                    title: 'åŸ¹æ ¹æ„é¢',
                    title: 'åŸ¹æ ¹æ„é¢',
                    image: 'https://images.unsplash.com/photo-1595295333158-4742f28fbd85',
                    tags: ['æ„é¤', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                },
                // æ·»åŠ æ›´å¤šåŸ¹æ ¹èœè°±...
                {
                    id: 'bacon_sandwich',
                    title: 'åŸ¹æ ¹ä¸‰æ˜æ²»',
                    image: 'https://images.unsplash.com/photo-1619096252214-ef06c45683e3',
                    tags: ['æ—©é¤', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                {
                    id: 'bacon_potato',
                    title: 'åŸ¹æ ¹åœŸè±†æ³¥',
                    image: 'https://images.unsplash.com/photo-1518679898075-9f59eef96448',
                    tags: ['å®¶å¸¸èœ', '25åˆ†é’Ÿ'],
                    time: '25åˆ†é’Ÿ'
                },
                {
                    id: 'bacon_brussels',
                    title: 'åŸ¹æ ¹çƒ¤çƒèŠ½ç”˜è“',
                    image: 'https://images.unsplash.com/photo-1584270354949-c26b0d5b4a0c',
                    tags: ['è¥¿é¤', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                },
                {
                    id: 'bacon_salad',
                    title: 'åŸ¹æ ¹æ²™æ‹‰',
                    image: 'https://images.unsplash.com/photo-1512621776951-a57141f2eefd',
                    tags: ['å‡‰èœ', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                }
            ],
            steak: [
                {
                    id: 'steak_simple',
                    title: 'é¦™ç…ç‰›æ’',
                    image: 'https://images.unsplash.com/photo-1600891964092-4316c288032e',
                    tags: ['è¥¿é¤', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                },
                // æ·»åŠ æ›´å¤šç‰›æ’èœè°±...
                {
                    id: 'steak_veg',
                    title: 'ç‰›æ’é…è”¬èœ',
                    image: 'https://images.unsplash.com/photo-1504973960431-1c467e159aa4',
                    tags: ['è¥¿é¤', '30åˆ†é’Ÿ'],
                    time: '30åˆ†é’Ÿ'
                },
                {
                    id: 'steak_mushroom',
                    title: 'ç‰›æ’é…è˜‘è‡é…±',
                    image: 'https://images.unsplash.com/photo-1546964124-0cce460f38ef',
                    tags: ['è¥¿é¤', '25åˆ†é’Ÿ'],
                    time: '25åˆ†é’Ÿ'
                },
                {
                    id: 'steak_sandwich',
                    title: 'ç‰›æ’ä¸‰æ˜æ²»',
                    image: 'https://images.unsplash.com/photo-1511344407683-b1172dce025f',
                    tags: ['å¿«é¤', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                },
                {
                    id: 'steak_salad',
                    title: 'ç‰›æ’æ²™æ‹‰',
                    image: 'https://images.unsplash.com/photo-1546793665-c74683f339c1',
                    tags: ['è½»é£Ÿ', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                },
                {
                    id: 'steak_rice',
                    title: 'ç‰›æ’ç‚’é¥­',
                    image: 'https://images.unsplash.com/photo-1603133872878-684f208fb84b',
                    tags: ['ä¸»é£Ÿ', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                }
            ],
            egg: [
                {
                    id: 'egg_tomato',
                    title: 'ç•ªèŒ„ç‚’è›‹',
                    image: 'https://images.unsplash.com/photo-1590779033100-9f60a05a013d',
                    tags: ['å®¶å¸¸èœ', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                {
                    id: 'egg_fried_rice',
                    title: 'è›‹ç‚’é¥­',
                    image: 'https://images.unsplash.com/photo-1603133872878-684f208fb84b',
                    tags: ['ä¸»é£Ÿ', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                },
                {
                    id: 'egg_soup',
                    title: 'è›‹èŠ±æ±¤',
                    image: 'https://images.unsplash.com/photo-1547592180-85f173990554',
                    tags: ['æ±¤å“', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                {
                    id: 'egg_pancake',
                    title: 'é¸¡è›‹é¥¼',
                    image: 'https://images.unsplash.com/photo-1525351484163-7529414344d8',
                    tags: ['æ—©é¤', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                },
                {
                    id: 'egg_custard',
                    title: 'è’¸è›‹ç¾¹',
                    image: 'https://images.unsplash.com/photo-1555949258-eb67b1ef0ceb',
                    tags: ['è’¸èœ', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                },
                {
                    id: 'egg_sandwich',
                    title: 'é¸¡è›‹ä¸‰æ˜æ²»',
                    image: 'https://images.unsplash.com/photo-1525351484163-7529414344d8',
                    tags: ['æ—©é¤', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                }
            ],
            tomato: [
                {
                    id: 'tomato_egg',
                    title: 'ç•ªèŒ„ç‚’è›‹',
                    image: 'https://images.unsplash.com/photo-1590779033100-9f60a05a013d',
                    tags: ['å®¶å¸¸èœ', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                {
                    id: 'tomato_soup',
                    title: 'ç•ªèŒ„æ±¤',
                    image: 'https://images.unsplash.com/photo-1547592180-85f173990554',
                    tags: ['æ±¤å“', '20åˆ†é’Ÿ'],
                    time: '20åˆ†é’Ÿ'
                },
                {
                    id: 'tomato_pasta',
                    title: 'ç•ªèŒ„æ„é¢',
                    image: 'https://images.unsplash.com/photo-1563379926898-05f4575a45d8',
                    tags: ['æ„é¤', '25åˆ†é’Ÿ'],
                    time: '25åˆ†é’Ÿ'
                },
                {
                    id: 'tomato_beef',
                    title: 'ç•ªèŒ„ç‚–ç‰›è‚‰',
                    image: 'https://images.unsplash.com/photo-1504973960431-1c467e159aa4',
                    tags: ['ç‚–èœ', '40åˆ†é’Ÿ'],
                    time: '40åˆ†é’Ÿ'
                },
                {
                    id: 'tomato_salad',
                    title: 'ç•ªèŒ„æ²™æ‹‰',
                    image: 'https://images.unsplash.com/photo-1551248429-40975aa4de74',
                    tags: ['å‡‰èœ', '10åˆ†é’Ÿ'],
                    time: '10åˆ†é’Ÿ'
                },
                {
                    id: 'tomato_rice',
                    title: 'ç•ªèŒ„ç‚’é¥­',
                    image: 'https://images.unsplash.com/photo-1603133872878-684f208fb84b',
                    tags: ['ä¸»é£Ÿ', '15åˆ†é’Ÿ'],
                    time: '15åˆ†é’Ÿ'
                }
            ]
        };
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            // æ¸²æŸ“é£Ÿæåˆ—è¡¨
            renderIngredients();
            
            // ç§»é™¤é¡µé¢åº•éƒ¨çš„ç­›é€‰å™¨ï¼ˆå› ä¸ºæˆ‘ä»¬ä¼šåœ¨æ¯ä¸ªé¢æ¿ä¸­æ·»åŠ ï¼‰
            const filterContainer = document.getElementById('filterContainer');
            if (filterContainer) {
                filterContainer.remove();
            }
            
            // æ¸²æŸ“èœè°±é¢æ¿
            renderRecipePanels();
            
            // è·å–ä¸Šæ¬¡é€‰æ‹©çš„é£Ÿæï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œå¦åˆ™é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªé£Ÿæ
            const lastSelectedIngredient = localStorage.getItem('currentIngredient') || ingredients[0].id;
            
            // æ¿€æ´»é€‰ä¸­çš„é£Ÿæ
            activateIngredient(lastSelectedIngredient);
            
            // å¤„ç†å›¾ç‰‡åŠ è½½
            handleImages();
        });
        
        // æ¸²æŸ“é£Ÿæåˆ—è¡¨
        function renderIngredients() {
            const ingredientsList = document.getElementById('ingredientsList');
            
            ingredients.forEach(ingredient => {
                const item = document.createElement('div');
                item.className = 'ingredient-item';
                item.dataset.id = ingredient.id;
                
                item.innerHTML = `
                    <div class="img-container">
                        <div class="placeholder">${ingredient.name}</div>
                        <img src="${ingredient.image}" 
                             class="progressive-img" 
                             alt="${ingredient.name}">
                    </div>
                    <div class="ingredient-name">${ingredient.name}</div>
                `;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                item.addEventListener('click', function() {
                    activateIngredient(ingredient.id);
                });
                
                ingredientsList.appendChild(item);
            });
        }
        
        // æ¸²æŸ“æ‰€æœ‰èœè°±é¢æ¿
        function renderRecipePanels() {
            const recipePanels = document.getElementById('recipePanels');
            
            // ä¸ºæ¯ç§é£Ÿæåˆ›å»ºé¢æ¿
            Object.keys(recipes).forEach(ingredientId => {
                const panel = document.createElement('div');
                panel.className = 'ingredient-panel';
                panel.id = `${ingredientId}Panel`;
                
                // è·å–é£Ÿæåç§°
                const ingredientName = ingredients.find(ing => ing.id === ingredientId)?.name || '';
                
                panel.innerHTML = `
                    <div class="recipe-section">
                        <div class="section-header">
                            <div class="section-title">å«"${ingredientName}"çš„èœè°±çµæ„Ÿ</div>
                            <div class="view-all">æŸ¥çœ‹å…¨éƒ¨ <span style="font-size: 20px; margin-left: 4px;">ï¼</span></div>
                        </div>
                        <!-- ç­›é€‰å™¨åŒºåŸŸ - ä½äºæ ‡é¢˜å’Œèœè°±å¡ç‰‡ä¹‹é—´ -->
                        <div class="filter-container">
                            <div class="filter-item"><div class="filter-text">å·²æœ‰èœç»„åˆ</div></div>
                            <div class="filter-item"><div class="filter-text">å®¶å¸¸èœ</div></div>
                            <div class="filter-item"><div class="filter-text">å¿«æ‰‹èœ</div></div>
                            <div class="filter-item"><div class="filter-text">å‡‰èœ</div></div>
                            <div class="filter-item"><div class="filter-text">ä¸‹é¥­èœ</div></div>
                        </div>
                        <div class="recipe-list" id="${ingredientId}RecipeList"></div>
                    </div>
                `;
                
                recipePanels.appendChild(panel);
                
                // æ¸²æŸ“è¯¥é£Ÿæçš„èœè°±åˆ—è¡¨
                renderRecipeList(ingredientId);
            });
        }
        
        // æ¸²æŸ“ç‰¹å®šé£Ÿæçš„èœè°±åˆ—è¡¨
        function renderRecipeList(ingredientId) {
            const recipeList = document.getElementById(`${ingredientId}RecipeList`);
            const recipeData = recipes[ingredientId] || [];
            const ingredientName = ingredients.find(ing => ing.id === ingredientId)?.name || '';
            
            recipeData.forEach(recipe => {
                // åˆ›å»ºèœè°±å¡ç‰‡
                const card = document.createElement('div');
                card.className = 'recipe-card';
                card.dataset.id = recipe.id;
                
                // æ„å»º3å±‚ç»“æ„çš„å¡ç‰‡ï¼ˆå®Œå…¨æŒ‰ç…§è®¾è®¡ç¨¿ï¼‰
                card.innerHTML = `
                    <!-- åº•å±‚ - ç™½è‰²åŠé€æ˜èƒŒæ™¯ + æ¨¡ç³Šæ•ˆæœ -->
                    <div class="recipe-card-bottom">
                        <!-- åº•å±‚çš„æ¨¡ç³ŠèƒŒæ™¯å›¾ -->
                        <img src="${recipe.image}" 
                             style="position: absolute; top: -5px; left: -5px; width: calc(100% + 10px); height: calc(100% + 10px); border-radius: 24px; object-fit: cover; opacity: 0.6; filter: blur(50px);"
                             alt="${recipe.title}"
                             onerror="this.style.display='none'">
                        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 24px; background-color: rgba(255, 255, 255, 0.5);"></div>
                    </div>
                    
                    <!-- ä¸­å±‚ - æ¸…æ™°èœè°±å›¾ -->
                    <div class="recipe-card-middle">
                        <div class="placeholder">${recipe.title}</div>
                        <img src="${recipe.image}" 
                             class="progressive-img" 
                             alt="${recipe.title}"
                             onload="this.classList.add('loaded')">
                    </div>
                    
                    <!-- é¡¶å±‚æ¸å˜é®ç½© -->
                    <div class="recipe-card-overlay"></div>
                    
                    <!-- é¡¶å±‚ - æ–‡å­—ã€æŒ‰é’®å’Œå…¶ä»–å…ƒç´  -->
                    <div class="recipe-card-top">
                        <div>
                            <div class="recipe-title">${recipe.title}</div>
                            <div class="recipe-tags">
                                ${recipe.tags.map(tag => `<span class="recipe-tag">${tag}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                `;
                
                // åˆ›å»ºé£Ÿæå±•ç¤ºåŒºåŸŸ
                const ingredientsContainer = document.createElement('div');
                ingredientsContainer.className = 'recipe-ingredients';
                
                // èœè°±å¿…éœ€é£Ÿææ˜ å°„è¡¨
                const recipeEssentialIngredients = {
                    'æ„é¢': ['pasta'],
                    'æ„å¤§åˆ©é¢': ['pasta'],
                    'ä¸‰æ˜æ²»': ['bread', 'lettuce'],
                    'ç‚’é¥­': ['rice'],
                    'ç‚’é¢': ['pasta'],
                    'æ²™æ‹‰': ['lettuce'],
                    'è‰²æ‹‰': ['lettuce'],
                    'æ±¤': ['mushroom', 'carrot', 'onion'],
                    'æµ“æ±¤': ['mushroom', 'carrot', 'onion'],
                    'ç‚–': ['potato', 'carrot', 'onion'],
                    'çƒ¤': ['garlic', 'onion'],
                    'è’¸': ['garlic'],
                    'ç…': ['garlic', 'onion'],
                    'åœŸè±†æ³¥': ['potato', 'garlic'],
                    'ç‰›æ’': ['steak'],
                    'è™¾ä»': ['shrimp'],
                    'åŸ¹æ ¹': ['bacon'],
                    'èŠ¦ç¬‹': ['asparagus'],
                    'ç•ªèŒ„': ['tomato'],
                    'é¸¡è›‹': ['egg'],
                    'è’œè“‰': ['garlic'],
                    'æ¤’': ['pepper'],
                    'èƒ¡èåœ': ['carrot'],
                    'è±†è…': ['garlic'],
                    'è›‹ç‚’é¥­': ['rice', 'egg'],
                    'è™¾ä»ç‚’é¥­': ['rice', 'shrimp'],
                    'ç‰›æ’ç‚’é¥­': ['rice', 'steak'],
                    'åŸ¹æ ¹æ„é¢': ['pasta', 'bacon'],
                    'è™¾ä»æ„é¢': ['pasta', 'shrimp'],
                    'èŠ¦ç¬‹æ„é¢': ['pasta', 'asparagus'],
                    'ç•ªèŒ„æ„é¢': ['pasta', 'tomato'],
                    'åŸ¹æ ¹ä¸‰æ˜æ²»': ['bread', 'bacon', 'lettuce'],
                    'é¸¡è›‹ä¸‰æ˜æ²»': ['bread', 'egg', 'lettuce'],
                    'ç‰›æ’ä¸‰æ˜æ²»': ['bread', 'steak', 'lettuce'],
                    'èŠ¦ç¬‹æ²™æ‹‰': ['lettuce', 'asparagus'],
                    'è™¾ä»æ²™æ‹‰': ['lettuce', 'shrimp'],
                    'ç•ªèŒ„æ²™æ‹‰': ['lettuce', 'tomato'],
                    'ç‰›æ’æ²™æ‹‰': ['lettuce', 'steak'],
                    'åŸ¹æ ¹æ²™æ‹‰': ['lettuce', 'bacon'],
                    'èŠ¦ç¬‹æµ“æ±¤': ['asparagus', 'onion', 'garlic'],
                    'èŠ¦ç¬‹ç‚’è™¾ä»': ['asparagus', 'shrimp']
                };
                
                // å…³é”®å­—ä¸é£Ÿæçš„æ˜ å°„ - å½“èœè°±åç§°ä¸­åŒ…å«æŸä¸ªå…³é”®å­—ä½†æ²¡æœ‰ç›´æ¥å¯¹åº”é£Ÿææ—¶ä½¿ç”¨
                const keywordIngredientMapping = {
                    'ç‰›è‚‰': ['steak'],
                    'çŒªè‚‰': ['bacon'],
                    'è±†è…': ['mushroom', 'garlic'],
                    'é±¼': ['garlic', 'onion'],
                    'é¸¡': ['garlic', 'carrot'],
                    'è‚‰': ['onion', 'garlic'],
                    'è‰²æ‹‰': ['lettuce', 'tomato'],
                    'æ„å¤§åˆ©': ['pasta'],
                    'è¥¿é¤': ['steak', 'pasta'],
                    'ä¸­é¤': ['rice'],
                    'æ—©é¤': ['egg', 'bread'],
                    'åˆé¤': ['rice', 'pasta'],
                    'æ™šé¤': ['potato', 'steak']
                };
                
                // è·å–ä¸»é£Ÿæåˆ—è¡¨
                let mainIngredients = [];
                
                // 1. ä¼˜å…ˆä»èœè°±åç§°ä¸­æå–é£Ÿæ
                for (const ing of ingredients) {
                    if (recipe.title.includes(ing.name)) {
                        mainIngredients.push(ing);
                    }
                }
                
                // 1.5 æ£€æŸ¥å…³é”®å­—æ˜ å°„ï¼Œå¦‚æœèœè°±åç§°ä¸­åŒ…å«ç‰¹å®šå…³é”®å­—ä½†æ²¡æœ‰æ‰¾åˆ°å¯¹åº”é£Ÿæ
                if (mainIngredients.length === 0) {
                    for (const [keyword, ingIds] of Object.entries(keywordIngredientMapping)) {
                        if (recipe.title.includes(keyword)) {
                            for (const ingId of ingIds) {
                                const keywordIng = ingredients.find(ing => ing.id === ingId);
                                if (keywordIng && !mainIngredients.some(mi => mi.id === keywordIng.id)) {
                                    mainIngredients.push(keywordIng);
                                }
                            }
                        }
                    }
                }
                
                // 2. æ£€æŸ¥èœè°±ç‰¹å®šç±»å‹ï¼Œæ·»åŠ å¿…éœ€é£Ÿæ
                for (const [recipeType, requiredIngIds] of Object.entries(recipeEssentialIngredients)) {
                    if (recipe.title.includes(recipeType)) {
                        for (const ingId of requiredIngIds) {
                            const essentialIng = ingredients.find(ing => ing.id === ingId);
                            if (essentialIng && !mainIngredients.some(mi => mi.id === essentialIng.id)) {
                                // å¦‚æœè¿™æ˜¯ä¸€ä¸ªå¿…éœ€é£Ÿæä¸”å°šæœªæ·»åŠ ï¼Œåˆ™æ·»åŠ å®ƒ
                                mainIngredients.push(essentialIng);
                            }
                        }
                    }
                }
                
                // 3. å¦‚æœèœè°±IDä¸­æœ‰é£Ÿæä¿¡æ¯ï¼Œä¹Ÿè€ƒè™‘è¿™äº›ä¿¡æ¯
                const recipeIdParts = recipe.id.split('_');
                if (recipeIdParts.length > 1) {
                    const mainIngredientId = recipeIdParts[0];
                    const secondIngredientId = recipeIdParts[1];
                    
                    // æ·»åŠ ä¸»é£Ÿæï¼ˆIDä¸­çš„ç¬¬ä¸€ä¸ªé£Ÿæï¼‰
                    const mainIng = ingredients.find(ing => ing.id === mainIngredientId);
                    if (mainIng && !mainIngredients.some(mi => mi.id === mainIng.id)) {
                        mainIngredients.push(mainIng);
                    }
                    
                    // æ·»åŠ ç¬¬äºŒä¸ªé£Ÿæï¼ˆIDä¸­çš„ç¬¬äºŒä¸ªé£Ÿæï¼‰
                    const secondIng = ingredients.find(ing => ing.id === secondIngredientId);
                    if (secondIng && !mainIngredients.some(mi => mi.id === secondIng.id)) {
                        mainIngredients.push(secondIng);
                    }
                }
                
                // éšæœºå†³å®šæ˜¾ç¤º2ä¸ªè¿˜æ˜¯3ä¸ªé£Ÿæï¼ˆ70%æ¦‚ç‡æ˜¾ç¤º3ä¸ªï¼‰
                const showThreeIngredients = Math.random() < 0.7;
                const minIngredients = 2; // æœ€å°‘æ˜¾ç¤º2ä¸ªé£Ÿæ
                const maxIngredients = showThreeIngredients ? 3 : 2; // æœ€å¤šæ˜¾ç¤º2ä¸ªæˆ–3ä¸ªé£Ÿæ
                
                // å¦‚æœå·²ç»æœ‰è¶…è¿‡æœ€å¤§æ•°é‡çš„é£Ÿæï¼Œä¼˜å…ˆä¿ç•™èœè°±åç§°ä¸­æåˆ°çš„é£Ÿæ
                if (mainIngredients.length > maxIngredients) {
                    // å…ˆæ’åºï¼š1. èœè°±åç§°ä¸­çš„é£Ÿæä¼˜å…ˆ 2. å¿…éœ€é£Ÿæå…¶æ¬¡ 3. å…¶ä»–é£Ÿææœ€å
                    mainIngredients.sort((a, b) => {
                        const aInTitle = recipe.title.includes(a.name);
                        const bInTitle = recipe.title.includes(b.name);
                        
                        if (aInTitle && !bInTitle) return -1;
                        if (!aInTitle && bInTitle) return 1;
                        return 0;
                    });
                    
                    // ä¿ç•™æ’åºåçš„å‰maxIngredientsä¸ªé£Ÿæ
                    mainIngredients = mainIngredients.slice(0, maxIngredients);
                }
                
                // ç¡®ä¿è‡³å°‘æœ‰æœ€å°‘æ•°é‡çš„é£Ÿæ
                if (mainIngredients.length < minIngredients) {
                    // æ ¹æ®èœè°±ç±»å‹ï¼Œæ¨èå¸¸è§çš„æ­é…é£Ÿæ
                    const commonPairings = {
                        'ç‰›æ’': ['æ´‹è‘±', 'è˜‘è‡', 'åœŸè±†', 'èƒ¡æ¤’', 'å¤§è’œ'],
                        'è™¾': ['è’œ', 'è‘±', 'å§œ', 'èŠ¦ç¬‹', 'èƒ¡èåœ', 'è¥¿å…°èŠ±'],
                        'é¸¡è›‹': ['ç•ªèŒ„', 'è‘±', 'ç‰›å¥¶', 'ç«è…¿', 'èŠå£«', 'è±†è…'],
                        'æ„é¢': ['ç•ªèŒ„', 'è’œ', 'æ´‹è‘±', 'æ©„æ¦„æ²¹', 'ç½—å‹’', 'èŠå£«'],
                        'æ²™æ‹‰': ['ç•ªèŒ„', 'é»„ç“œ', 'ç”Ÿèœ', 'æŸ æª¬', 'æ©„æ¦„æ²¹'],
                        'æ±¤': ['æ´‹è‘±', 'èƒ¡èåœ', 'èŠ¹èœ', 'å§œ'],
                        'ä¸‰æ˜æ²»': ['ç”Ÿèœ', 'ç•ªèŒ„', 'èŠå£«', 'ç«è…¿'],
                        'ç‚’é¥­': ['é¸¡è›‹', 'è‘±', 'èƒ¡èåœ', 'è±Œè±†'],
                        'ç‚’é¢': ['è‘±', 'è’œ', 'èƒ¡èåœ', 'å½©æ¤’']
                    };
                    
                    // å¯»æ‰¾èœè°±ç±»å‹
                    let recipeType = null;
                    for (const [type, _] of Object.entries(commonPairings)) {
                        if (recipe.title.includes(type)) {
                            recipeType = type;
                            break;
                        }
                    }
                    
                    // å°è¯•æ·»åŠ å¸¸è§æ­é…é£Ÿæ
                    if (recipeType && commonPairings[recipeType]) {
                        const commonIngs = [];
                        for (const ingName of commonPairings[recipeType]) {
                            const ing = ingredients.find(i => i.name.includes(ingName) || ingName.includes(i.name));
                            if (ing && !mainIngredients.some(mi => mi.id === ing.id)) {
                                commonIngs.push(ing);
                            }
                        }
                        
                        // éšæœºé€‰æ‹©ä¸€äº›å¸¸è§é£Ÿææ·»åŠ 
                        if (commonIngs.length > 0) {
                            const shuffled = [...commonIngs].sort(() => 0.5 - Math.random());
                            mainIngredients = [...mainIngredients, ...shuffled.slice(0, minIngredients - mainIngredients.length)];
                        }
                    }
                    
                    // å¦‚æœä»ä¸è¶³æœ€å°‘æ•°é‡ï¼Œå†è€ƒè™‘æ·»åŠ éšæœºé£Ÿæ
                    if (mainIngredients.length < minIngredients) {
                        const otherIngredients = ingredients.filter(ing => !mainIngredients.some(mi => mi.id === ing.id));
                        const shuffled = [...otherIngredients].sort(() => 0.5 - Math.random());
                        mainIngredients = [...mainIngredients, ...shuffled.slice(0, minIngredients - mainIngredients.length)];
                    }
                }
                
                // å¦‚æœéœ€è¦æ˜¾ç¤º3ä¸ªé£Ÿæä½†å½“å‰ä¸è¶³3ä¸ªï¼Œä¼˜å…ˆæ·»åŠ ä¸èœè°±æˆ–ç°æœ‰é£Ÿæç›¸å…³çš„é£Ÿæ
                if (showThreeIngredients && mainIngredients.length < maxIngredients) {
                    // è·å–å¯èƒ½çš„ç›¸å…³é£Ÿæï¼ˆä¸èœè°±ç±»å‹æˆ–ç°æœ‰é£Ÿæç›¸å…³çš„ï¼‰
                    const relatedIngredients = [];
                    
                    // æ£€æŸ¥æ˜¯å¦æœ‰ä¸èœè°±åç§°ç›¸å…³çš„å…¶ä»–é£Ÿæ
                    for (const ing of ingredients) {
                        if (!mainIngredients.some(mi => mi.id === ing.id)) {
                            // æ£€æŸ¥è¿™ä¸ªé£Ÿææ˜¯å¦ä¸èœè°±åç§°æˆ–ç°æœ‰é£Ÿæç›¸å…³
                            const isRelatedToRecipe = recipe.title.toLowerCase().includes(ing.name.toLowerCase());
                            const isRelatedToCurrentIngredients = mainIngredients.some(mi => 
                                mi.name.toLowerCase().includes(ing.name.toLowerCase()) || 
                                ing.name.toLowerCase().includes(mi.name.toLowerCase())
                            );
                            
                            if (isRelatedToRecipe || isRelatedToCurrentIngredients) {
                                relatedIngredients.push(ing);
                            }
                        }
                    }
                    
                    // æ·»åŠ ç›¸å…³é£Ÿæ
                    if (relatedIngredients.length > 0) {
                        const shuffled = [...relatedIngredients].sort(() => 0.5 - Math.random());
                        mainIngredients = [...mainIngredients, ...shuffled.slice(0, maxIngredients - mainIngredients.length)];
                    } else {
                        // å¦‚æœæ²¡æœ‰æ˜æ˜¾ç›¸å…³çš„é£Ÿæï¼Œæ·»åŠ ä¸€ä¸ªéšæœºçš„å¸¸è§è¾…æ–™
                        const commonCondiments = ingredients.filter(ing => 
                            ['ç›', 'èƒ¡æ¤’', 'é…±æ²¹', 'é†‹', 'ç³–', 'æ–™é…’', 'æ²¹', 'è’œ', 'å§œ', 'è‘±'].some(name => 
                                ing.name.includes(name)
                            ) && !mainIngredients.some(mi => mi.id === ing.id)
                        );
                        
                        if (commonCondiments.length > 0) {
                            const shuffled = [...commonCondiments].sort(() => 0.5 - Math.random());
                            mainIngredients = [...mainIngredients, ...shuffled.slice(0, maxIngredients - mainIngredients.length)];
                        } else {
                            // æœ€åæ‰è€ƒè™‘æ·»åŠ éšæœºé£Ÿæ
                            const otherIngredients = ingredients.filter(ing => !mainIngredients.some(mi => mi.id === ing.id));
                            if (otherIngredients.length > 0) {
                                const shuffled = [...otherIngredients].sort(() => 0.5 - Math.random());
                                mainIngredients = [...mainIngredients, ...shuffled.slice(0, maxIngredients - mainIngredients.length)];
                            }
                        }
                    }
                }
                
                // é£Ÿææ’åºé€»è¾‘ï¼š
                // 1. èœè°±åç§°ä¸­å‡ºç°çš„é£Ÿæä¼˜å…ˆ
                // 2. "å·²æœ‰"çš„é£Ÿæï¼ˆå½“å‰é€‰ä¸­çš„é£Ÿæè¢«è§†ä¸º"å·²æœ‰"ï¼‰å…¶æ¬¡
                // 3. å…¶ä»–é£Ÿææœ€å
                mainIngredients.sort((a, b) => {
                    const aInTitle = recipe.title.includes(a.name);
                    const bInTitle = recipe.title.includes(b.name);
                    const aIsAvailable = a.id === ingredientId;
                    const bIsAvailable = b.id === ingredientId;
                    
                    // ä¼˜å…ˆçº§1ï¼šèœè°±æ ‡é¢˜ä¸­çš„é£Ÿæ
                    if (aInTitle && !bInTitle) return -1;
                    if (!aInTitle && bInTitle) return 1;
                    
                    // ä¼˜å…ˆçº§2ï¼šå·²æœ‰çš„é£Ÿæï¼Œä½†è¦ç¡®ä¿ä¸ä¼šå¯¼è‡´å¿…éœ€çš„ä¸»è¦é£Ÿæè¢«æ’é™¤
                    // å¦‚åŸ¹æ ¹æ„é¢ï¼Œä¸èƒ½å› ä¸ºå·²æœ‰åŸ¹æ ¹è€Œæ’é™¤æ„é¢
                    const recipeMainType = Object.keys(recipeEssentialIngredients).find(type => recipe.title.includes(type));
                    if (recipeMainType) {
                        const essentialIngIds = recipeEssentialIngredients[recipeMainType];
                        const aIsEssential = essentialIngIds.includes(a.id);
                        const bIsEssential = essentialIngIds.includes(b.id);
                        
                        // å¿…éœ€é£Ÿæä¼˜å…ˆäºå·²æœ‰é£Ÿæ
                        if (aIsEssential && !bIsEssential) return -1;
                        if (!aIsEssential && bIsEssential) return 1;
                    }
                    
                    // å¦‚æœéƒ½ä¸æ˜¯å¿…éœ€é£Ÿææˆ–éƒ½æ˜¯å¿…éœ€é£Ÿæï¼Œåˆ™å·²æœ‰é£Ÿæä¼˜å…ˆ
                    if (aIsAvailable && !bIsAvailable) return -1;
                    if (!aIsAvailable && bIsAvailable) return 1;
                    
                    return 0;
                });
                
                // æ¸²æŸ“é£Ÿæåˆ—è¡¨
                mainIngredients.forEach((ing, index) => {
                    const ingElement = document.createElement('div');
                    ingElement.className = 'recipe-ingredient';
                    
                    // æ£€æŸ¥æ­¤é£Ÿææ˜¯å¦"å·²æœ‰"ï¼ˆå½“å‰é€‰ä¸­çš„é£Ÿæè¢«è§†ä¸º"å·²æœ‰"ï¼‰
                    const isAvailable = ing.id === ingredientId;
                    
                    // ç¡®ä¿z-indexæ­£ç¡®ï¼Œå‰é¢çš„é£Ÿæå±‚çº§æ›´é«˜
                    const zIndex = 10 - index; // ä½¿ç”¨æ›´é«˜çš„z-indexå€¼
                    ingElement.style.zIndex = zIndex;
                    
                    // æ ¹æ®ç´¢å¼•è°ƒæ•´å·¦è¾¹è·ï¼Œè®©æ¯ä¸ªé£Ÿæéƒ½èƒ½æ¸…æ™°å¯è§
                    if (index > 0) {
                        ingElement.style.marginLeft = '-20px'; // ä½¿ç”¨è´Ÿè¾¹è·åˆ›å»ºé‡å æ•ˆæœ
                    }
                    
                    // æ„å»ºé£ŸæHTML
                    let ingredientHtml = `
                        <div class="ingredient-img">
                            <img src="${ing.image}" alt="${ing.name}">
                        </div>
                        <div class="ingredient-label">${ing.name}</div>
                    `;
                    
                    // å¦‚æœæ˜¯"å·²æœ‰"é£Ÿæï¼Œæ·»åŠ æ ‡ç­¾
                    if (isAvailable) {
                        ingredientHtml += `<div class="ingredient-has">å·²æœ‰</div>`;
                    }
                    
                    ingElement.innerHTML = ingredientHtml;
                    ingredientsContainer.appendChild(ingElement);
                });
                
                // æ·»åŠ è´­ä¹°æŒ‰é’®
                const purchaseBtn = document.createElement('button');
                purchaseBtn.className = 'purchase-btn';
                purchaseBtn.innerHTML = `é£Ÿæé€‰è´­<div class="purchase-btn-arrow">ï¼</div>`;
                purchaseBtn.onclick = function() { goToPurchase(recipe.id); };
                
                // ç¡®ä¿è´­ä¹°æŒ‰é’®å’Œé£Ÿæå®¹å™¨ä¸é‡å 
                if (mainIngredients.length >= 3) {
                    // å¦‚æœæœ‰3ä¸ªé£Ÿæï¼Œè°ƒæ•´è´­ä¹°æŒ‰é’®çš„ä½ç½®
                    purchaseBtn.style.right = '24px';
                } else {
                    // å¦‚æœåªæœ‰2ä¸ªé£Ÿæï¼Œå¯ä»¥å°†æŒ‰é’®å‘å·¦ç§»åŠ¨
                    purchaseBtn.style.right = '40px';
                }
                
                // å°†é£Ÿæå±•ç¤ºåŒºåŸŸå’Œè´­ä¹°æŒ‰é’®æ·»åŠ åˆ°å¡ç‰‡
                card.appendChild(ingredientsContainer);
                card.appendChild(purchaseBtn);
                
                recipeList.appendChild(card);
            });
        }
        
        // æ¿€æ´»ç‰¹å®šé£Ÿæ
        function activateIngredient(ingredientId) {
            // ä¿å­˜å½“å‰é€‰æ‹©çš„é£Ÿæ
            localStorage.setItem('currentIngredient', ingredientId);
            
            // æ›´æ–°é£Ÿæåˆ—è¡¨UI
            const ingredients = document.querySelectorAll('.ingredient-item');
            ingredients.forEach(item => {
                if (item.dataset.id === ingredientId) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // æ›´æ–°èœè°±é¢æ¿UI
            const panels = document.querySelectorAll('.ingredient-panel');
            panels.forEach(panel => {
                if (panel.id === `${ingredientId}Panel`) {
                    panel.classList.add('active');
                } else {
                    panel.classList.remove('active');
                }
            });
        }
        
        // å¤„ç†å›¾ç‰‡åŠ è½½
        function handleImages() {
            const images = document.querySelectorAll('.progressive-img');
            
            images.forEach(img => {
                if (img.complete && !img.naturalWidth == 0) {
                    img.classList.add('loaded');
                } else {
                    img.addEventListener('load', function() {
                        this.classList.add('loaded');
                    });
                    
                    img.addEventListener('error', function() {
                        // è·å–å›¾ç‰‡çš„altæ–‡æœ¬ï¼ˆé£Ÿææˆ–èœè°±åç§°ï¼‰
                        const altText = this.alt || 'åŠ è½½å¤±è´¥';
                        
                        // è·å–çˆ¶å®¹å™¨
                        const container = this.parentNode;
                        
                        // éšè—å¤±è´¥çš„å›¾ç‰‡
                        this.style.display = 'none';
                        
                        // æŸ¥æ‰¾æˆ–åˆ›å»ºå ä½ç¬¦
                        let placeholder = container.querySelector('.placeholder');
                        if (!placeholder) {
                            placeholder = document.createElement('div');
                            placeholder.className = 'placeholder';
                            container.appendChild(placeholder);
                        }
                        
                        // è®¾ç½®å ä½ç¬¦æ ·å¼å’Œå†…å®¹
                        placeholder.style.display = 'flex';
                        placeholder.style.backgroundColor = '#f0f0f0';
                        placeholder.style.color = '#666';
                        placeholder.textContent = altText;
                        
                        // å¦‚æœæ˜¯åœ†å½¢å®¹å™¨ï¼ˆé£Ÿæå›¾ç‰‡ï¼‰ï¼Œæ·»åŠ ç‰¹æ®Šæ ·å¼
                        if (container.classList.contains('img-container')) {
                            placeholder.style.borderRadius = '50%';
                        }
                    });
                }
            });
        }
        
        // è·³è½¬åˆ°è´­ä¹°é¡µ
        function goToPurchase(recipeId) {
            // è·å–å®Œæ•´çš„èœè°±å¯¹è±¡
            const ingredientId = localStorage.getItem('currentIngredient') || ingredients[0].id;
            const recipeData = recipes[ingredientId] || [];
            const selectedRecipe = recipeData.find(r => r.id === recipeId);
            
            if (selectedRecipe) {
                // å°†å®Œæ•´çš„èœè°±å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ä¿å­˜
                const recipeWithIngredients = {
                    ...selectedRecipe,
                    ingredients: []
                };
                
                // è·å–èœè°±ä¸­çš„é£Ÿæ
                const recipeIdParts = recipeId.split('_');
                if (recipeIdParts.length > 1) {
                    const mainIngredientId = recipeIdParts[0];
                    const secondIngredientId = recipeIdParts[1];
                    
                    // æ·»åŠ ä¸»é£Ÿæï¼Œæ ‡è®°ä¸º"å·²æœ‰"
                    const mainIng = ingredients.find(ing => ing.id === mainIngredientId);
                    if (mainIng) {
                        recipeWithIngredients.ingredients.push({
                            name: mainIng.name,
                            image: mainIng.image,
                            has: mainIng.id === ingredientId
                        });
                    }
                    
                    // æ·»åŠ ç¬¬äºŒä¸ªé£Ÿæ
                    const secondIng = ingredients.find(ing => ing.id === secondIngredientId);
                    if (secondIng) {
                        recipeWithIngredients.ingredients.push({
                            name: secondIng.name,
                            image: secondIng.image,
                            has: secondIng.id === ingredientId
                        });
                    }
                }
                
                // ç¡®ä¿è‡³å°‘æœ‰2ä¸ªé£Ÿæ
                if (recipeWithIngredients.ingredients.length < 2) {
                    // æå–èœè°±æ ‡é¢˜ä¸­å¯èƒ½åŒ…å«çš„é£Ÿæ
                    const titleIngredients = ingredients.filter(ing => 
                        !recipeWithIngredients.ingredients.some(ri => ri.name === ing.name) && 
                        selectedRecipe.title.includes(ing.name)
                    );
                    
                    if (titleIngredients.length > 0) {
                        // ä¼˜å…ˆæ·»åŠ æ ‡é¢˜ä¸­æåˆ°çš„é£Ÿæ
                        titleIngredients.slice(0, 2 - recipeWithIngredients.ingredients.length).forEach(ing => {
                            recipeWithIngredients.ingredients.push({
                                name: ing.name,
                                image: ing.image,
                                has: ing.id === ingredientId
                            });
                        });
                    }
                    
                    // å¦‚æœè¿˜ä¸è¶³2ä¸ªï¼Œæ·»åŠ éšæœºé£Ÿæ
                    if (recipeWithIngredients.ingredients.length < 2) {
                        const otherIngredients = ingredients.filter(ing => 
                            !recipeWithIngredients.ingredients.some(ri => ri.name === ing.name)
                        );
                        const shuffled = [...otherIngredients].sort(() => 0.5 - Math.random());
                        shuffled.slice(0, 2 - recipeWithIngredients.ingredients.length).forEach(ing => {
                            recipeWithIngredients.ingredients.push({
                                name: ing.name,
                                image: ing.image,
                                has: ing.id === ingredientId
                            });
                        });
                    }
                }
                
                // ä¿å­˜å®Œæ•´èœè°±å¯¹è±¡
                localStorage.setItem('selectedRecipe', JSON.stringify(recipeWithIngredients));
            } else {
                // å¦‚æœæ‰¾ä¸åˆ°èœè°±ï¼Œåªä¿å­˜ID
                localStorage.setItem('selectedRecipe', recipeId);
            }
            
            // è·³è½¬åˆ°è´­ä¹°é¡µ
            window.location.href = `purchase.html?recipe=${recipeId}`;
        }
        
        // è¿”å›ä¸Šä¸€é¡µ
        function goBack() {
            window.location.href = 'recognition.html';
        }
    </script>
</body>
</html> 